# **`#define` マクロ**

## サンプルコード

```cpp
#include <stdio.h>

// 1. 定数の定義
#define PI 3.14159

// 2. マクロ関数の定義
#define SQUARE(x) ((x) * (x))

int main() {
    // 3. 定数マクロを使用
    printf("円周率: %.5f\n", PI); // 実行結果："円周率: 3.14159"

    // 4. マクロ関数を使用
    int num = 5;
    printf("5の二乗: %d\n", SQUARE(num));      // 実行結果："5の二乗: 25"
    printf("5+1の二乗: %d\n", SQUARE(num + 1)); // 実行結果："5+1の二乗: 36"

    return 0;
}
```

---

## 解説

### **`#define` の役割**
`#define` は、コンパイル前にコードを置き換えるための **プリプロセッサ指令** です。主に以下の目的で使用されます：

1. **定数の定義**: 値を固定することでコードの可読性を向上させます。  
   ```cpp
   #define 定数名 値
   ```

2. **マクロ関数の定義**: 簡単な式や処理をまとめて再利用できます。  
   ```cpp
   #define マクロ名(引数) 式
   ```

---

### **コード解説**

#### **1. 定数マクロ**
`#define PI 3.14159`  
これにより、コード中の `PI` がすべて `3.14159` に置き換えられます。  

例:  
```cpp
printf("円周率: %.5f\n", PI);
// コンパイラには以下のコードとして認識されます：
// printf("円周率: %.5f\n", 3.14159);
```

#### **2. マクロ関数**
`#define SQUARE(x) ((x) * (x))`  
これにより、`SQUARE(x)` が `((x) * (x))` に置き換えられます。  

例:  
```cpp
SQUARE(5 + 1)
// コンパイラには以下のコードとして認識されます：
// ((5 + 1) * (5 + 1)) → 36
```

**注意**: マクロ関数には括弧を適切に使用しないと、予期しない動作を引き起こすことがあります。

---

### **注意点**

1. **デバッグが難しい**  
   `#define` はコードの置き換えに基づくため、エラー箇所が分かりにくくなることがあります。

2. **型の安全性がない**  
   マクロはコンパイル前に単純に置き換えられるため、引数や型のチェックが行われません。

3. **括弧の使用**  
   マクロ定義内では、すべての引数や計算式を括弧で囲むのがベストプラクティスです。

---

## 演習課題

### **1日目: 定数を定義する**

- **概要**: `#define` を使って以下の定数を定義してください。
  - 円周率 (PI): 3.14
  - 重力加速度 (G): 9.8
- **条件**:  
  - `main` 関数でこれらの値を出力してください。

---

### **2日目: マクロ関数を定義する**

- **概要**: 以下のマクロ関数を作成してください。
  - `CUBE(x)` : 引数 `x` の三乗を計算するマクロ
  - `MAX(a, b)` : 2つの値のうち大きい方を返すマクロ
- **条件**:  
  - それぞれのマクロを使用して計算結果を出力してください。
  - `MAX(a, b)` は三項演算子で実装してください。
---

### **3日目: マクロ関数を複数行で定義する**

- **概要**: 先日作成したマクロ関数 `MAX(a, b)` を複数行で定義するように変更する
- **条件**:  
  - `MAX(a, b)` の内容を三項演算子からif文に変更してください
  - 複数行でマクロ関数を定義することになります
  - マクロが複数行になる時は、以下の様に行の終わりにバックスラッシュ(\)をつけて改行します
    ```cpp
    #define TOTAL_NUM	\
    (HEADER_NUM_1 + HEADER_NUM_2 + HEADER_NUM_3 +	\
    BODY_NUM_1 + BODY_NUM_2 + BODY_NUM_3 + 		\
    FOOTER_NUM_1 + FOOTER_NUM_2 + FOOTER_NUM_3)
    ```

---

### **4日目: マクロとローカル変数**

- **概要**: `#define` を使って配列のサイズを定義してください。
- **条件**:  
  - 配列サイズを `#define ARRAY_SIZE 10` で定義し、そのサイズを利用して配列を作成します。
  - 配列に値を代入し、出力してください。

---

### **5日目: 条件付きマクロ**

- **概要**: 条件付きコンパイル (`#ifdef`) を使って以下を実装してください。
- **条件**:  
  - `DEBUG` が定義されている場合はデバッグ用のメッセージを出力します。
  - 定義されていない場合は通常のメッセージを出力します。

  例:  
  ```cpp
  #ifdef DEBUG
    printf("デバッグモード\n");
  #else
    printf("通常モード\n");
  #endif
  ```

---